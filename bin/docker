#!/usr/bin/env bash

# Reutilizado de https://github.com/mmaximo33/EFDE/

print_url(){
  echo "Check URL "
  echo "   - https://localhost"
  echo "   - https://localhost:8080"
}

if docker compose version > /dev/null 2>&1; then
  DOCKER_COMPOSE_COMMAND="docker compose"
else
  DOCKER_COMPOSE_COMMAND="docker-compose"
fi

case "$1" in
  "up")
    ${DOCKER_COMPOSE_COMMAND} up -d --build
    #sudo chown -R $USER:www-data app/*
    #sudo chmod -R -x bin/*
    print_url
    ;;
  "start")
    ${DOCKER_COMPOSE_COMMAND} start
    print_url
    ;;
  "stop")
    echo "Deteniendo el contenedor Docker..."
    ${DOCKER_COMPOSE_COMMAND} stop
    ;;
  "allstop")
    echo "Stop apache"
    sudo service apache2 stop
    echo "Stop all containers"
    docker stop $(docker ps -aq)
    ;;
  "restart")
    ${DOCKER_COMPOSE_COMMAND} restart
    print_url
    ;;
  "logs")
    ${DOCKER_COMPOSE_COMMAND} logs -f
    ;;
  *)
    echo "Uso: $0 {up|start|allstop|stop|restart|logs}"
    #exit 1
    ;;
esac

